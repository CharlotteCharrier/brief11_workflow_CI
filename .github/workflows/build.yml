on:
  push:
    branches:
      -main
      -beta

permissions:
  contents: write

jobs:
  get-version:
     uses: shiipou/github-actions/.github/workflows/get-version.yml@main

  build:
    name: Rust build
    runs-on: ubuntu-latest
    if: ${{ needs.get-version.outputs.will-release == 'true' }}
    needs:
      - get-version
    steps:
      - name: Print version
        run: |
         echo "${{ needs.get-version.outputs.version }}"
         echo "${{ needs.get-version.outputs.changelogs }}"
         echo "${{ needs.get-version.outputs.is-pre-release }}"
         echo "${{ needs.get-version.outputs.will-release }}"
      - name: Setup Rust
        uses: actions/checkout@v2
      - name: Install latest nightly
        uses: actions-rs/toolchain@v1
        with:
          toolchain: nightly
          override: true
          components: rustfmt, clippy
      - name: Setup trunk
        uses: trunk-io/trunk-action@v1.1.14

      
        
      
  
